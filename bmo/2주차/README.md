# 2주차 서버 스터디 정리

## 외부  IP vs 내부 IP
앞으로 줄기차게 사용할 것이고, 이전에도 많이 들어봤던 IP! 
IP란 무엇일까요??

### IP란?
**Internet Protocol** 의 약자로, 인터넷을 하면서 가끔 봤던 59.7.111.1의 형식으로 되어있는 인터넷 기기 각각에게 주어지는 주소입니다.
![image](https://user-images.githubusercontent.com/35029025/161500618-52e68a50-9f2e-4aab-9469-75ea65274796.png)

위의 그림을 보시면, 8글자의 2진수가 4칸에 나눠서 들어가 있는 것을 볼 수 있어요. 그러면 우리는 이론상, 2^32 -> 즉 4,294,967,296개의 기기들에 인터넷 주소를 할당할 수 있겠네요!
라고 말하고 끝나면 좋겠지만, 사실 전세계의 인터넷이 되는 기기를 전부 모으면, 40억개는 족히 넘을거에요. 여기서 **외부IP(공인 IP)**와 **내부IP(사설IP)** 개념이 등장합니다!!

### 외부 IP

아주아주 특별한 경우가 아닌 이상, 한 집에는 __개의 외부(공인)IP가 주어집니다.

아까 우리는, IP를 정의할 때 IP란 인터넷이 되는 기기마다 주소가 부여되는 것이라고 했어요.
그런데, 방금 한 집에는 하나의 IP가 주어진다고 했죠???
그럼에도 불구하고, 여러분이 집에서 데스크탑과 노트북, 스마트폰, 태블릿등을 하나의 공유기 WiFi에서 사용할 수 있는 이유는 **내부 IP가 따로 주어지기 때문**이에요.

### 내부 IP
외부에서 주어진 공인 아이피를, 내부에서 쪼개서 씁니다!
사설 IP대역은, 10._____, 172._____, 192.______으로 시작하는 것들이에요. 
아마, 실습을 진행하면서 ipconfig(unix는 ifconfig)를 치면 많이 보셨을 주소일텐데요,
이러한 내부 IP로 외부의 IP를 여러개로 쪼개서 사용한답니다.

외부 IP가 아파트의 동 주소라고 치면, 내부 IP는 호 주소를 의미한다고 말할 수 있겠네요!

## 서버하면 이건 알아야지~ 프로토콜 정리
검색해서, 채워주세요!

 - FTP
	 - 포트 번호: 21
	 - 역할: 파일 전송 프로토콜(File Transfer Protocol) 
 - SMTP
	 - 포트 번호: 25
	 - 역할: 전자 우편 전송 프로토콜(Simple Mail Transfer Protocol)
 - HTTP
	 - 포트 번호: 80
	 - 역할: 하이퍼 텍스트 전송 프로토콜(Hyper Text Transfer Protocol)
 - HTTPS
	 - 포트 번호: 443
	 - 역할: 암호화된 HTTP (HTTP Secure) //SSL이나 TSL 사용
 - SSH
	 - 포트 번호: 22
	 - 역할: 보안 통신 프로토콜 (Secure Shell Protocol)
 - DNS
	 - 포트 번호: 53
	 - 역할: 도메인 이름 변경 시스템 (Domain Name System) //도메인 주소와 IP주소를 변환
 ## 그래서 포트가 뭔데??
 각각의 응용 프로그램에 이미 정해져있는 포트 번호를 이용하여, 
 전송계층에서 응용프로그램을 구분 하는 역할을 수행한다!

우리가 인터넷을 사용할때는 연결이 허투루 되는 것이 아니에요.
다음 그림을 보시죠!
![](https://t1.daumcdn.net/cfile/tistory/995EFF355B74179035)

> **1계층 - 물리계층(Physical Layer)**
> 
> 이 계층에서는 주로 전기적, 기계적, 기능적인 특성을 이용해서 통신 케이블로 데이터를 전송하게 된다.
> 
> 이 계층에서 사용되는 통신 단위는 비트이며 이것은 1과 0으로 나타내어지는, 즉 전기적으로 On, Off 상태라고 생각하면
> 된다.
> 
> **2계층 - 데이터 링크 계층(DataLink Layer)**
> 
> 물리계층을 통해 송수신되는 정보의 오류와 흐름을 관리하여 안전한 **정보의 전달을 수행**할 수 있도록 도와주는 역할을 한다.
> 
> 따라서 통신에서의 오류도 찾아주고 재전송도 하는 기능을 가지고 있는 것이다.
> 
> 이 계층에서는 **맥 주소를 가지고 통신**하게 된다.
> 
> **3계층 - 네트워크 계층(Network Layer)**
> 
> 이 계층에서 가장 중요한 기능은 **데이터를 목적지까지 가장 안전하고 빠르게 전달하는 기능(라우팅)**이다.
> 
> 여기에 사용되는 프로토콜의 종류도 다양하고, 라우팅하는 기술도 다양하다.
> 
> **4계층 - 전송 계층(Transport Layer)**
> 
> 통신을 활성화하기 위한 계층이다. 보통 TCP프로토콜을 이용하며, 포트를 열어서 응용프로그램들이 전송을 할 수 있게 한다.
> 
> 만약 데이터가 왔다면 4계층에서 해당 데이터를 하나로 합쳐서 5계층에 던져 준다.
> 
> 단대단 오류제어 및 흐름제어 이 계층 까지는 물리적인 계층에 속한다.(TCP/UDP프로토콜을 사용한다.)
> 
> **5계층 - 세션 계층(Session Layer)**
> 
> **데이터가 통신하기 위한 논리적인 연결**을 말한다. 통신을 하기위한 대문이라고 보면 된다.
> 
> 하지만 4계층에서도 연결을 맺고 종료할 수 있기 때문에 우리가 어느 계층에서 통신이 끊어 졌나 판단하기는 한계가 있다.
> 
> 그러므로 세션 계층은 4 계층과 무관하게 응용 프로그램 관점에서 봐야 한다.
> 
> 세션 설정, 유지, 종료, 전송 중단시 복구 등의 기능이 있다.
> 
> **6계층 - 표현 계층(Presentation Layer)**
> 
> 데이터 표현이 상이한 응용 프로세스의 독립성을 제공하고, 암호화 한다.
> 
> 표현 계층(Presentation layer)은 코드 간의 번역을 담당하여 사용자 시스템에서 데이터의 형식상 차이를 다루는
> 부담을 응용 계층으로부터 덜어 준다. MIME 인코딩이나 암호화 등의 동작이 이 계층에서 이루어진다.
> 
> **7계층 - 응용 계층(Application Layer)**
> 
> 최종 목적지로서 HTTP, FTP, SMTP, POP3, IMAP, Telnet 등과 같은 프로토콜이 있다.
> 
> 해당 통신 패킷들은 방금 나열한 프로토콜에 의해 모두 처리되며 우리가 사용하는 브라우저나, 메일 프로그램은 프로토콜을
> 
> 보다 쉽게 사용하게 해주는 응용프로그램이다. 한마디로 모든 통신의 양 끝단은 HTTP와 같은 프로토콜이지 응용프로그램이 아니다.
> 
이렇게 아래서 위로! 패킷을 처리하면서 올리게 됩니다.

## 포트포워딩과 DNS
포트포워딩과, DNS를 짚고 넘어가봅시다.

### DNS란?
cmd(혹은 터미널)를 켜고, 다음 명령어를 입력해 봅시다.

    nslookup naver.com
그럼 네이버의 ip주소가 공개됩니다. 
확인된 네이버의 공인 ip주소는 223.130.200.104 입니다.

이 ip주소는 네이버의 공인 ip주소인데요,
**DNS는 인간이 알아들을 수 있는 영어로 된 주소인 www.naver.com을 공인 ip 223.130.200.104로 연결시켜주는 역할을 합니다.**

### 포트포워딩
외부의 포트를 내부의 포트로 연결시켜주는 역할을 합니다.

아까 말한 개념이 모두 등장하니까, 잘 따라오셔야해요!

우리는 이미 외부 ip 즉 공인 ip가 단 한개라는 것을 알고 있습니다.
우리의 내부 ip는, 외부의 ip를 나눠서 여러 디바이스가 사용하는 것으로 알고 있었죠.

만약 우리가 서버를 돌리는 컴퓨터가 192.168.0.12의 **내부 ip주소를 가지고 있다**고 해봅시다. 
우리의 서버 컴퓨터에 접속하려면 외부 ip를 타고! 우리의 컴퓨터에 도달해야하는데요,

단 하나의 외부 ip주소만을 가지고, 서버가 돌아가고 있는 컴퓨터의 내부 ip주소를 어떻게 찾아갈까요??

이것을 설정해주는 것이 바로 **포트포워딩입니다.**

![](https://cdn.lamanus.kr/wp-content/uploads/2019/05/29004625/59-2-2048x1152.png)
출처: https://lamanus.kr/59
